{"map":"{\"version\":3,\"file\":\"session.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/session.ts\"],\"names\":[],\"mappings\":\";AAAA,OAAO,EAAE,WAAW,EAAiC,MAAM,QAAQ,CAAC;AAEpE,OAAO,KAAK,KAAK,MAAM,MAAM,CAAC;AAE9B,IAAI,IAAI,GAAQ,SAAS,CAAC;AAC1B,IAAI,GAAG,GAAQ,SAAS,CAAC;AAEzB,WAAW;AACX,oBAAoB;AACpB,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;IACjC,aAAa;IACb,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC;IACrB,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC;CAClB;AACD,QAAQ;KACH;IACH,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;IACvB,GAAG,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC;CAC1B;AAED;IAiBE,qBACS,GAAW,EACX,QAAgB,EACvB,OAAoB,EACpB,MAAmB;QAHZ,QAAG,GAAH,GAAG,CAAQ;QACX,aAAQ,GAAR,QAAQ,CAAQ;QAIvB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC;QAC5B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,OAAO;YACV,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO;gBAClC,CAAC,CAAC,IAAI,CAAC,OAAO;gBACd,CAAC,CAAC,EAAE,OAAO,EAAE,IAAI,GAAG,EAAE,EAAE,CAAC;QAC7B,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,WAAW,EAAE,CAAC;IACpD,CAAC;IAEY,6BAAO,GAApB,UACE,MAAc,EACd,GAAW,EACX,IAAY;;;;;;wBAEN,GAAG,GAAG,IAAI,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;wBAClC,OAAO,GAAgB,EAAE,OAAO,EAAE,IAAI,GAAG,EAAE,EAAE,CAAC;wBACpD,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,uBAAuB,EAAE,GAAG,CAAC,CAAC;wBAClD,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;wBAC1D,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,qBAAqB,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;wBAC5D,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,kBAAkB,CAAC,CAAC;wBAExD,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,GAAG;4BACtC,OAAA,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC;wBAA/B,CAA+B,CAChC,CAAC;wBAEa,qBAAM,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,OAAO,CAAC,EAAA;;wBAAhE,QAAQ,GAAG,SAAqD;wBACpE,sBAAO,QAAQ,CAAC,IAAI,EAAC;;;;KACtB;IACH,kBAAC;AAAD,CAAC,AAnDD,IAmDC\"}","code":"import { __awaiter, __generator } from \"tslib\";\r\nimport { AxiosClient } from './http';\r\nimport * as _uuid from 'uuid';\r\nvar uuid = undefined;\r\nvar URL = undefined;\r\n// Browser.\r\n/* tslint:disable */\r\nif (typeof window !== 'undefined') {\r\n    // @ts-ignore\r\n    uuid = _uuid.default;\r\n    URL = window.URL;\r\n}\r\n// Node.\r\nelse {\r\n    uuid = require('uuid');\r\n    URL = require('url').URL;\r\n}\r\nvar HttpSession = /** @class */ (function () {\r\n    function HttpSession(url, apiToken, headers, client) {\r\n        this.url = url;\r\n        this.apiToken = apiToken;\r\n        this.sessionKey = uuid.v4();\r\n        this.headers = headers;\r\n        this.headers =\r\n            this.headers && this.headers.headers\r\n                ? this.headers\r\n                : { headers: new Map() };\r\n        this.client = client ? client : new AxiosClient();\r\n    }\r\n    HttpSession.prototype.request = function (method, api, body) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var url, headers, response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        url = new URL(api, this.url).href;\r\n                        headers = { headers: new Map() };\r\n                        headers.headers.set('X-OASIS-INSECURE-AUTH', '1');\r\n                        headers.headers.set('X-OASIS-LOGIN-TOKEN', this.apiToken);\r\n                        headers.headers.set('X-OASIS-SESSION-KEY', this.sessionKey);\r\n                        headers.headers.set('Content-type', 'application/json');\r\n                        this.headers.headers.forEach(function (value, key) {\r\n                            return headers.headers.set(key, value);\r\n                        });\r\n                        return [4 /*yield*/, this.client.request(method, url, body, headers)];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        return [2 /*return*/, response.data];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return HttpSession;\r\n}());\r\nexport { HttpSession };\r\n//# sourceMappingURL=session.js.map","dts":{"name":"/Users/armaniferrante/Documents/code/src/github.com/oasislabs/tttt/oasis.js/packages/gateway/dist/lib/src/session.d.ts","writeByteOrderMark":false,"text":"import { HttpClient, HttpHeaders, Http } from './http';\r\nexport declare class HttpSession implements Http {\r\n    url: string;\r\n    apiToken: string;\r\n    /**\r\n     * session key passed to the developer gateway in the header.\r\n     */\r\n    private sessionKey;\r\n    /**\r\n     * headers are the default headers that the session will use for all\r\n     * http requests\r\n     */\r\n    private headers;\r\n    /**\r\n     * underlying http client for the http requests\r\n     */\r\n    private client;\r\n    constructor(url: string, apiToken: string, headers: HttpHeaders, client?: HttpClient);\r\n    request(method: string, api: string, body: Object): Promise<any>;\r\n}\r\n"}}
